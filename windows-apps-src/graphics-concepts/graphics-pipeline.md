---
title: 图形管道
description: Direct3D 图形管道旨在为实时游戏应用程序生成图形。 数据通过各个可配置或可编程的阶段从输入流到输出。
ms.assetid: C9519AD0-5425-48BD-9FF4-AED8959CA4AD
keywords:
- 图形管道
- 管道阶段
ms.date: 02/08/2017
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: 55621cec768e0aac680c3a84fd803e591459a97d
ms.sourcegitcommit: d2517e522cacc5240f7dffd5bc1eaa278e3f7768
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/30/2018
ms.locfileid: "8351734"
---
# <a name="graphics-pipeline"></a>图形管道


Direct3D 图形管道旨在为实时游戏应用程序生成图形。 数据通过各个可配置或可编程的阶段从输入流到输出。

所有阶段都可以使用 Direct3D API 进行配置。 具有常见着色器核心（圆角矩形块）的阶段可通过使用 [HLSL](https://msdn.microsoft.com/library/windows/desktop/bb509561) 编程语言进行编程。 这使得管道具有非常高的灵活性和适应性。

最常用的是顶点着色器 (VS) 阶段和像素着色器 (PS) 阶段。 如果你甚至不提供这些着色器阶段，则使用默认的无操作、传递式顶点和像素着色器。

![direct3d 11 可编程管道中的数据流图示](images/d3d11-pipeline-stages.jpg)

## <a name="input-assembler-stage"></a>输入装配器阶段

|-|-| |用途 |[输入装配器 (IA) 阶段](input-assembler-stage--ia-.md)提供基元和邻接数据向管道，例如三角形、 线和点，包括语义 Id，以减少对尚未已经的基元的处理，从而提高着色器的效率处理。 ||输入 |基元数据 （三角形、 线和/或点），从内存中的用户填充缓冲区。 和可能的邻接数据。 三角形将为每个三角形的 3 个顶点和每个三角形邻接数据可能是 3 个顶点。 ||输出 |（例如基元 ID、 实例 ID 或顶点 ID） 的附加系统生成值的基元。 |

## <a name="vertex-shader-stage"></a>顶点着色器阶段

|-|-| |用途 |[顶点着色器 (VS) 阶段](vertex-shader-stage--vs-.md)处理顶点，通常执行诸如转换、 操作换肤以及照明。 顶点着色器获取一个输入顶点并生成一个输出顶点。 单个每顶点操作，如转换、 换肤、 变形和每顶点照明。 ||输入 |具有 VertexID 和 InstanceID 系统生成值的单个顶点。 每个顶点着色器输入的顶点可以最多 16 个 32 位矢量 （最多 4 个组件每个） 组成。 ||输出 |单个顶点。 每个输出顶点可以多达 16 个 32 位 4 分量矢量组成。 |
 
## <a name="hull-shader-stage"></a>外壳着色器阶段
 
|-|-| |用途 |[外壳着色器 (HS) 阶段](hull-shader-stage--hs-.md)是分割阶段之一，其有效地分解为许多三角形模型的单个表面。 每个修补程序调用一次外壳着色器，它将定义低阶表面的输入控制点转换为构成修补程序的控制点。 它还执行一些每个修补程序计算，以便为细化器 (TS) 阶段和域着色器 (DS) 阶段提供数据。 ||输入 |1 之间 32 输入的控制点，它们共同定义低阶表面。 ||输出 |1 到 32 个输出控制点之间，它们共同构成修补程序。 外壳着色器声明细化器 (TS) 阶段中，包括控制点、 修补程序的类型和使用时面的的分区类型的数量的状态。 |

## <a name="tessellator-stage"></a>细化器阶段

|-|-| |用途 |[细化器 (TS) 阶段](tessellator-stage--ts-.md)创建代表几何图形修补程序并生成连接这些样本的较小对象 （三角形、 点或线） 的一组的域的采样模式。 ||输入 |细化器每个使用分割因子 （指定域将细化精细度） 以及的分区类型 （这指定用于修补程序切片的算法），从外壳着色器阶段传入的修补程序运行一次。 | |输出 |细化器将输出 uv （和可选 w） 坐标和表面拓扑到域着色器阶段。 |

## <a name="domain-shader-stage"></a>域着色器阶段

|-|-| |用途 |[域着色器 (DS) 阶段](domain-shader-stage--ds-.md)计算输出修补程序; 中细分点的顶点位置它计算与每个域样本对应的顶点位置。 域着色器运行一次每个细化器阶段输出点和具有只读访问外壳着色器输出修补程序、 输出修补程序常量以及细化器阶段输出 UV 坐标。 ||输入 |域着色器使用来自[外壳着色器 (HS) 阶段](hull-shader-stage--hs-.md)输出控制点。 外壳着色器输出包括：控制点、修补程序常数数据和细化因素（例如，细化因素可以包括固定函数细化器使用的值以及原始值（例如在被整数细化舍入前），这有助于加快几何过渡）。 域着色器每个[细化器 (TS) 阶段](tessellator-stage--ts-.md)输出坐标调用一次。 ||输出 |域着色器 (DS) 阶段输出输出修补程序中细分点的顶点位置。 |

## <a name="geometry-shader-stage"></a>几何着色器阶段

|-|-| |用途 |[几何着色器 (GS) 阶段](geometry-shader-stage--gs-.md)处理整个基元： 三角形、 线和点，以及它们的相邻顶点。 它支持几何放大和解扩。 它对于点精灵扩展、动态粒子系统、皮毛/鳍生成、阴影卷生成、单通道渲染到 Cubemap、每基元材料交换和每基元材料设置等算法很有用 - 包括将重心坐标生成为基元数据，使得像素着色器可以执行定制属性内插。 | |输入 |与顶点着色器，在单个顶点运行，几何着色器的输入是一个完整的基元 （三个顶点的三角形、 线的两个顶点或点的单个顶点） 的顶点。 ||输出 |几何着色器 (GS) 阶段是能够输出形成单个选定的拓扑的多个顶点。 可用的几何着色器输出拓扑有 <strong>tristrip</strong>、<strong>linestrip</strong> 和 <strong>pointlist</strong>。 在几何着色器的任何调用中，发出的基元的数目可以自由地变化，但是必须静态地声明可发出的顶点的最大数目。 从几何着色器调用发出的带长度可以是任意的并且可以通过[RestartStrip](https://msdn.microsoft.com/library/windows/desktop/bb509660) HLSL 函数创建新带。 |

## <a name="stream-output-stage"></a>流输出阶段

|-|-| |用途 |[流输出 (SO) 阶段](stream-output-stage--so-.md)连续地将输出 （或流入） 到内存中的一个或多个缓冲区的顶点数据从前一活动阶段。 流出到内存的数据可以再次循环回到管道作为输入的数据，或者从 CPU 读回。 ||输入 |来自前一管道阶段的顶点数据。 ||输出 |流输出 (SO) 阶段连续地输出 （或流入） 到内存中的一个或多个缓冲区的顶点数据从前一活动阶段，例如几何着色器 (GS) 阶段。 如果几何着色器 (GS) 阶段是非活动的并且流输出 (SO) 阶段处于活动状态时，它持续输出到内存 （或者如果 DS 也无效，则从顶点着色器 (VS) 阶段） 中的缓冲区来自域着色器 (DS) 阶段的顶点数据。 |

## <a name="rasterizer-stage"></a>光栅器阶段

|-|-| |用途 |未在视图中的[光栅器 (RS) 阶段](rasterizer-stage--rs-.md)剪辑基元为像素着色器 (PS) 阶段准备基元并确定如何调用像素着色器。 将矢量信息 （由形状或基元构成） 转换为光栅图像 （由像素构成） 以便显示实时 3D 图形。 ||输入 |顶点 （x，y，z） w 进入光栅器阶段假定将处于齐性裁剪空间。 在此坐标空间 X 轴指向右、 向上箭头 Y 和 Z 点摄像机。 ||输出 |需要呈现的实际像素。 包括一些顶点属性用于由像素着色器进行内插。 |

## <a name="pixel-shader-stage"></a>像素着色器阶段
 
|-|-| |用途 |[像素着色器 (PS) 阶段](pixel-shader-stage--ps-.md)接收基元的插值的数据并生成每像素数据，如颜色。 ||输入 |配置管道时未使用几何着色器，像素着色器将仅限于 16 个 32 位 4 分量输入。 否则，像素着色器可能占用多达 32 个 32 位 4 分量输入。 像素着色器输入数据包含顶点属性（可以在使用或不使用透视校正的情况下内插），或者也可以被视为每基元常量。 像素着色器输入根据声明的内插模式从正在光栅化的基元的顶点属性内插。 如果基元在光栅化之前被剪裁，内插模式在剪裁过程中也受支持。 | |输出 |像素着色器可输出多达 8 个 32 位 4 分量颜色或没有颜色如果像素被弃用。 像素着色器输出寄存器分量必须声明才能使用它们。不同的输出写入掩码允许每个寄存器。 |

## <a name="output-merger-stage"></a>输出合并阶段
 
|-|-| |用途 |[输出合并 (OM) 阶段](output-merger-stage--om-.md)将各种类型的输出数据 （像素着色器值、 深度和模具信息） 与呈现器目标和深度/模具缓冲区，以生成最终的管道结果的内容相结合。 ||输入 |输出合并输入是管道状态，由像素着色器、 呈现目标的内容和深度/模具缓冲区的内容生成的像素数据。 ||输出 |最终渲染的像素颜色。 |

## <a name="related-topics"></a>相关主题

- [Direct3D 图形学习指南](index.md)

- [计算管道](compute-pipeline.md)

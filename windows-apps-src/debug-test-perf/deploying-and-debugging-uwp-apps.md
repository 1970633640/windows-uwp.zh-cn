---
author: mcleblanc
ms.assetid: 9322B3A3-8F06-4329-AFCB-BE0C260C332C
description: "本文指导你完成针对各种部署和调试目标的步骤。"
title: "部署和调试通用 Windows 平台 (UWP) 应用"
translationtype: Human Translation
ms.sourcegitcommit: 14f6684541716034735fbff7896348073fa55f85
ms.openlocfilehash: e2209e90080c7346bb363304b1a28f6446300332

---

# 部署和调试通用 Windows 平台 (UWP) 应用

\[ 已针对 Windows 10 上的 UWP 应用更新。 有关 Windows 8.x 文章，请参阅[存档](http://go.microsoft.com/fwlink/p/?linkid=619132) \]

本文指导你完成针对各种部署和调试目标的步骤。

Microsoft Visual Studio 允许你在各种 Windows 10 设备上部署和调试通用 Windows 平台 (UWP) 应用。 Visual Studio 将处理在目标设备上生成和注册应用程序的过程。

## 选取部署目标

若要选取目标，请导航到**“开始调试”**按钮旁边的调试目标下拉列表，然后选择你想要将应用程序部署到的目标。 选取目标后，选择**“开始调试 (F5)”**以在该目标上进行部署和调试，或者按**“Ctrl+F5”**以仅对该目标进行部署。

![](images/debug-device-target-list.png)

-   **“本地计算机”**会将应用程序部署到当前开发计算机。 仅当你的应用程序的**“目标平台最小版本”**小于或等于你的开发计算机操作系统版本时，此选项才可用。
-   **“仿真器”**会将应用程序部署到当前开发计算机上的仿真环境。 仅当你的应用程序的**“目标平台最小版本”**小于或等于你的开发计算机操作系统版本时，此选项才可用。
-   **“设备”**会将应用程序部署到 USB 连接设备。 该设备必须已针对开发人员解锁，并且已解锁屏幕。
-   “仿真器”****目标会使用名称中指定的配置将应用程序启动并部署到仿真器。 仿真器仅适用于运行 Windows 8.1 或更高版本且支持 Hyper-V 的计算机。
-   **“远程计算机”**允许你指定要部署应用程序的远程目标。 可以在[指定远程设备](#specifying-a-remote-device)中找到有关部署到远程计算机的详细信息。

## 调试已部署的应用
通过依次选择“调试”****、“附加到进程”****，Visual Studio 还可以附加到任何运行的 UWP 应用进程。 附加到运行的进程不需要原始 Visual Studio 项目，但是在调试没有原始代码的进程时，加载进程的[符号](#symbols)有很大的帮助。  
  
此外，可以通过依次选择“调试”****、“其他”****和“调试安装的应用程序包”****来附加和调试任何安装的应用包。   
 
![“调试安装的应用程序包”对话框](images/gs-debug-uwp-apps-002.png)  

选择“不启动，但在启动时调试代码”****将导致 Visual Studio 调试程序在你在自定义时打开它时附加到你的 UWP 应用。 这是从[不同的启动方法](../xbox-apps/automate-launching-uwp-apps.md)调试控件路径的有效方法，如使用自定义参数的协议激活。  

可以在 Windows 8.1 或更高版本上开发和编译 UWP 应用，但需要运行 Windows 10。 如果你要在 Windows 8.1 电脑上开发 UWP 应用，你可以远程调试在另一台 Windows 10 设备上运行的 UWP 应用，前提是主机和目标计算机在同一个 LAN 上。 若要执行此操作，请在两台计算机上下载和安装 [Visual Studio 远程工具](http://aka.ms/remotedebugger)。 已安装的版本必须与你已安装的现有 Visual Studio 版本匹配，并且你选择的体系结构（x86、x64）还必须与你的目标应用程序的体系结构匹配。   
  

## 指定远程设备

### C# 和 Microsoft Visual Basic

若要指定适用于 C# 或 Microsoft Visual Basic 应用的远程计算机，请在调试目标下拉列表中选择**“远程计算机”**。 **“远程连接”**对话框将会出现，这将允许你指定 IP 地址或选择一台已发现的设备。 默认情况下，选择**“通用”**身份验证模式。 若要确定要使用的身份验证模式，请参阅[身份验证模式](#authentication-modes)。

![](images/debug-remote-connections.png)

若要返回到此对话框，可以打开项目属性，然后导航到“调试”****选项卡。 在此处，选择“远程计算机:”****旁边的 “查找...”****

![](images/debug-remote-machine-config.png)

若要将应用程序部署到远程电脑，你还需要在目标电脑上下载并安装 Visual Studio 远程工具。 有关完整说明，请参阅[远程电脑说明](#remote-pc-instructions)。

### C++ 和 JavaScript

若要指定适用于 C++ 或 JavaScript UWP 应用的远程计算机目标，通过右键单击**“解决方案资源管理器”**中的项目并单击**“属性”**来转到项目属性。 导航到“调试”****设置，并将“要启动的调试器”****更改为“远程计算机”****。 然后填写**计算机名称**（或单击“查找...”**** 找到一个计算机），并设置“身份验证类型”****属性。

![](images/debug-property-pages.png)
指定计算机后，可以在调试目标下拉列表中选择“远程计算机”****，以返回到指定的计算机。 一次只能选择一台远程计算机。

### 远程电脑说明

若要部署到远程电脑，目标电脑上必须已安装 Visual Studio 远程工具。 远程电脑上运行的 Windows 版本还必须大于或等于你的应用**“目标平台最小版本”**属性。 在安装了远程工具之后，还必须启动目标电脑上的远程调试器。 若要执行此操作，请在**“开始”**菜单中搜索**“远程调试器”**、启动它，然后在系统提示时允许该调试器配置你的防火墙设置。 默认情况下，调试器启动时会执行 Windows 身份验证。 如果两台电脑上的登录用户不是同一人，会要求用户提供凭据。 若要将它更改为“无身份验证”****，请在“远程调试器”****中转到“工具”**** -&gt;“选项”****，然后将它设置为“无身份验证”****。 完成远程调试器设置后，可以从开发计算机进行部署。

有关详细信息，请参阅[Visual Studio 远程工具]( http://go.microsoft.com/fwlink/?LinkId=717039)下载页。

## 身份验证模式

有三个身份验证模式可用于远程计算机部署：

- “通用(未加密协议)”****：只要部署到的远程设备不是 Windows 电脑（台式机或笔记本电脑），就使用此身份验证模式。 当前，仅限 IoT 设备。 仅应在信任的网络上使用通用（未加密协议）。 调试连接对于恶意用户来说容易遭受攻击，这些用户可以截获和更改在开发与远程计算机之间传递的数据。
- “Windows”****：此身份验证模式仅适用于远程电脑部署（台式机或笔记本电脑）。 当你有权访问目标计算机的登录用户的凭据时，使用此身份验证模式。 这是适用于远程部署的最安全通道。
- “无”****：此身份验证模式仅适用于远程电脑部署（台式机或笔记本电脑）。 当在登录测试帐户的环境中设置测试计算机并且无法输入凭据时，使用此身份验证模式。 确保远程调试器设置已设置为接受“无身份验证”。

## 调试选项

在 Windows 10 中，通过使用称为[预启动](https://msdn.microsoft.com/library/windows/apps/Mt593297)的技术主动启动应用并随后暂停该应用来改进 UWP 应用的启动性能。 许多应用程序不需要执行任何特殊操作就可在此模式下工作，但某些应用程序可能需要调整它们的行为。 若要帮助调试这些代码路径中的任何问题，你可以在 Visual Studio 中使用预启动模式开始调试该应用。 在 Visual Studio 项目（“调试”**** -&gt;“其他调试目标”**** -&gt;“调试通用 Windows 应用预启动”****）和计算机上已安装的应用（“调试”**** -&gt;“其他调试目标”**** -&gt;“调试安装的应用包”****，并选中“激活具有预启动的应用”****复选框）中都支持调试。 有关详细信息，请阅读有关如何[调试 UWP 预启动]( http://go.microsoft.com/fwlink/?LinkId=717245)的信息。

可以在启动项目的**“调试”**属性页上设置以下部署选项。

**允许网络环回**

出于安全原因，以标准方式安装的 UWP 应用不允许对安装了它的设备进行网络调用。 默认情况下，Visual Studio 部署针对已部署应用从此规则创建豁免。 此豁免允许你在单台计算机上测试通信过程。 将你的应用提交至 Windows 应用商店之前，应对不具有豁免的应用进行测试。

若要从应用中删除网络环回豁免：

-   在 C# 和 Visual Basic**“调试”**属性页上，清除**“允许网络环回”**复选框。
-   在 JavaScript 和 C++**“调试”**属性页上，将**“允许网络环回”**值设置为**“否”**。

**不启动，但在开始时调试我的代码（C# 和 Visual Basic）/启动应用（JavaScript 和 C++）**

若要将部署配置为启动应用时自动开始一个调试会话：

-   在 C# 和 Visual Basic**“调试”**属性页上，选中**“不启动，但在开始时调试我的代码”**复选框。
-   在 JavaScript 和 C++“调试”****属性页上，将“启动应用程序”****值设置为“是”****。

## 符号

符号文件包含各种在调试代码时非常有用的数据，如变量、函数名称和入口点地址，从而使你可以更好地了解异常和调用堆栈执行顺序。 适用于 Windows 的大多数变体的符号通过 [Microsoft 符号服务器](http://msdl.microsoft.com/download/symbols)提供，或者可以下载，以供在[下载 Windows 符号包](http://aka.ms/winsymbols)中更快速地离线查找。

若要为 Visual Studio 设置符号选项，请依次选择“工具”&gt;“选项”****，然后在对话窗口中依次导航到“调试”&gt;“符号”****。

**图 4.“选项”对话框。**
![“选项”对话框](images/gs-debug-uwp-apps-004.png)

若要使用 [WinDbg](#windbg) 在调试会话中加载符号，请将 **sympath** 变量设置为符号包位置。 例如，运行以下命令将从 Microsoft 符号服务器加载符号，然后将它们缓存在  C:\Symbols 目录中：

```
.sympath SRV*C:\Symbols*http://msdl.microsoft.com/download/symbols
.reload
```

你可以使用“;”分隔符添加多个路径，或使用 `.sympath+` 命令。 有关使用 WinDbg 的更高级符号运算，请参阅[公共和私有符号](https://msdn.microsoft.com/library/windows/hardware/ff553493)。

## WinDbg

WinDbg 是 Windows 调试工具套件随附的一款功能强大的调试器，它包含在 [Windows SDK](http://go.microsoft.com/fwlink/p?LinkID=271979) 中。 Windows SDK 安装允许你安装 Windows 调试工具作为独立产品。 尽管对调试本机代码非常有用，但我们不建议为使用托管代码或 HTML5 编写的应用使用 WinDbg。 

若要将 WinDbg 用于 UWP 应用，你将需要先使用 PLMDebug 为你的应用包禁用 PLM，如上一部分中所述。 

```
plmdebug /enableDebug [PackageFullName] "\"C:\Program Files\Debugging Tools for Windows (x64)\WinDbg.exe\" -server npipe:pipe=test"
```

与 Visual Studio 相反，WinDbg 的大部分核心功能依赖于向命令窗口提供命令。 所提供的命令允许你查看执行状态、调查用户模式崩溃转储并在各种模式下进行调试。 

WinDbg 中最常用的命令之一是 `!analyze -v`，该命令用于检索大量有关当前异常的信息，包括：

- FAULTING_IP：故障发生时的指令指针
- EXCEPTION_RECORD：当前异常的地址、代码和标志
- STACK_TEXT：异常之前的堆栈跟踪

有关所有 WinDbg 命令的完整列表，请参阅[调试器命令](https://msdn.microsoft.com/library/ff540507)。

## 相关主题
- [进程周期管理 (PLM) 的测试和调试工具](testing-debugging-plm.md)
- [调试、测试和性能](index.md)



<!--HONumber=Jun16_HO4-->



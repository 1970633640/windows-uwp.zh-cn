---
title: 脱机最佳实践
author: KevinAsgari
description: 了解在支持 Xbox Live 的游戏中处理脱机情形的最佳实践。
ms.assetid: 6290dd67-1145-4fe2-8ada-c3a29a9ad29a
ms.author: kevinasg
ms.date: 04/04/2017
ms.topic: article
keywords: Xbox live, xbox, 游戏, uwp, windows 10, xbox one, 脱机
ms.localizationpriority: medium
ms.openlocfilehash: a552f275a69fde67f22d25a79b5b8c318c4f8dc3
ms.sourcegitcommit: e38b334edb82bf2b1474ba686990f4299b8f59c7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/15/2018
ms.locfileid: "6837627"
---
# <a name="best-practices-for-offline"></a>脱机最佳实践

Xbox One 作为连接设备设计，最佳体验（如多人游戏和视频流）需要连接网络。 但是，Xbox One 不支持多种形式的脱机玩游戏。 本主题讨论如何处理脱机玩游戏。

## <a name="overview"></a>概述

全球范围内越来越多的消费者可以访问 Internet。 但是，世界上仍有一些地方的网络连接不可预测，有时候也会遇到路由器故障、光纤切断、服务器崩溃或无线服务下降的情况。

为了支持最广范围的消费者和体验，Xbox One 支持常见的 Internet 连接不时中断或不可用的情况。 游戏将会通知你连接故障，并且你可以自由地选择如何应对 - 不论是继续玩完整个游戏、降级至脱机模式还是完全结束游戏。

## <a name="normal-online-operation"></a>正常联机操作

一般情况下，Xbox One 主机将在完全连接状态下工作，在此状态下，用户具有稳定的 Internet 连接并且可以完整访问 Xbox Live 和第三方服务。 该连接状态允许 Xbox Live 服务定期验证主机状态、提供更新和执行其他有益于游戏和用户的后台服务。

我们建议你假定用户大部分时间具有联机连接性。

## <a name="offline-play-principles"></a>脱机玩游戏的原则

在某些情况下在线连接不可用。 对于脱机玩游戏，Xbox One 在设计时考虑了以下原则：

-   最重要的是，让用户能够继续玩游戏，不受网络连接问题的影响。

-   让用户能够继续玩游戏，即便他们完全没有网络连接。

-   让脱机玩游戏对用户来说变得简单并且可预测，同时仍然坚持始终联网体验的精神。

## <a name="offline-modes"></a>脱机模式

两种高级*连接中断*情形如下：

-   Internet 服务完全中断

-   一项或多项联机服务中断

在每种模式下，可能会产生不同的情况。 下面将会通过影响玩游戏的常见脱机情形示例介绍这些情况。

## <a name="offline-scenario-no-internet-service-upon-game-start"></a>脱机情形：游戏开始时无 Internet 服务

游戏可能声明自己是以下三种类型之一：

-   *需要 Xbox Live*：所有玩游戏模式均需要 Internet 连接。

-   *需要 Xbox Live 金会员*：所有玩游戏模式均需要 Internet 连接和 Xbox Live 金会员资格。

-   *不需要 Xbox Live*：此游戏至少有一种玩游戏模式不需要 Internet 连接。 从技术上来说，这种类型不会在应用程序清单中显式声明。 未将自己声明为前两种类型之一的应用将被视为“不需要 Xbox Live” 或不支持脱机。

当用户启动游戏且主机处于脱机状态时，系统将检查应用程序清单中的游戏连接声明。 如果游戏需要网络连接（上面前两种情况之一），则系统将向用户自动显示一条消息并且不会启动游戏。

如果主机处于脱机状态，则系统将仅启动至少有一种玩游戏模式不需要网络连接的游戏。 换而言之，系统不会启动“需要 Xbox Live”或“需要 Xbox Live 金会员”游戏。

## <a name="offline-scenario-connectivity-lost-during-gameplay"></a>脱机情形：在玩游戏过程中连接中断

如果在游戏运行过程中连接中断，则系统将会通知游戏。 如果游戏未使用联机服务，则将继续该会话，不会中断。 如果游戏当前正使用联机服务，则会切换至不再需要这些服务的模式，或者通知玩家游戏会话因处于脱机状态将结束。

当主机丢失所有网络连接一段时间时，系统将自动挂起声明为“需要 Xbox Live”或“需要 Xbox Live 金会员”的游戏，并且系统将会向用户自动提供一条错误消息。

对于涉及玩游戏挂起的任何其他情形，你应保存状态，以便用户不会丢失数据并且可以在恢复网络连接后快速返回至相应的状态。

## <a name="offline-scenario-when-a-single-xbox-live-service-is-down"></a>脱机情形：单个 Xbox Live 服务关闭时

在某些其他情况下，即便 Internet 连接正常，但一些特定的联机服务可能仍不可用。

例如，单个 Xbox Live 服务在短时间内可能脱机。 在此情况下，调用特定服务将超时或向游戏报告错误。 你可以像在 Xbox 360 或 Windows 上处理这些情况一样处理脱机服务状态。

至少，游戏不会崩溃或挂起。 如果无该项服务游戏无法继续，则将此情况报告给用户，并允许用户在不需要使用此项服务的其他游戏区域继续。

在最佳情况下，继续玩游戏并缓存数据以稍后发送（如果游戏将写入到服务）或对数据进行合理的假设（如果游戏通过服务进行读取）。

## <a name="offline-scenario-when-a-third-party-service-is-down"></a>脱机情形：第三方服务关闭时

如果你的游戏依赖于第三方服务，则游戏必须在该项服务故障时也能够复原。 如果该项服务故障，游戏不会崩溃或挂起。 当游戏无法继续时，你可以将服务错误报告给用户。 理论上来说，应该可以继续玩游戏或者你应该允许用户在不需要使用此项联机服务的游戏区域继续。

## <a name="offline-scenario-when-xbox-live-cloud-compute-is-down"></a>脱机情形：Xbox Live 云计算关闭时

Xbox One 展示之一为云能力。 某些游戏可能完全依赖于始终连接的服务，如 Xbox Live 云计算，它允许访问其他计算功能或始终可用的游戏服务器。 允许并鼓励使用该始终连接模式，以改善玩家体验。

如果你的游戏使用此模式，则我们建议你的游戏复原为因 Internet 连接完全中断或特定云服务中断产生的服务中断（多秒到最多一分钟）。 但是，游戏无需具有脱机模式。 如果游戏确实需要网络连接且连接不可用，则通知用户并结束玩游戏会话。

## <a name="xbox-requirements"></a>Xbox 要求

处理脱机情形时最重要的要求是游戏的稳定性。 无论是连接完全中断还是只有特定联机服务中断，你的游戏都不得挂起、崩溃或致使用户丢失状态。 你的游戏必须具有稳定的系统来处理网络超时情形和处理任何 API 访问联机服务时返回的错误。

游戏不需要支持脱机玩游戏。 如果你的游戏只因服务连接中断而无法继续，则通知用户，结束游戏会话，然后返回主菜单或发起交互状态。

## <a name="best-practices"></a>最佳实践

以下是处理脱机情形的最佳实践：

-   将游戏设计为假定用户大部分时间具有联机连接性。

-   如果这对游戏设计有意义，则考虑设计玩游戏的模式，即便主机处于脱机状态，也能让用户拥有愉快的体验。

-   服务可能不可用。 连接可能失败。 为可能超时的 API 构建强大的错误处理系统，或者在联机服务关闭或 Internet 连接中断时报告故障情况。 尽可能地让用户能够继续玩游戏，即便是出现这些问题。

-   Obey Xbox 要求 (XR)。 不要挂起或崩溃。

-   收到 PLM 游戏挂起通知时，保存状态，从而使用户不会丢失数据并且在恢复游戏时可以快速返回至该状态。

-   在应用程序清单中相应地标记你的游戏。 仅当所有玩游戏模式均需要网络连接时才将游戏标记为“需要 Xbox Live”。

-   在所有游戏模式下，Xbox One 游戏允许使用并依赖于联机服务。 如果游戏只因服务连接中断而无法继续，则通知用户，结束游戏会话，然后返回主菜单或发起交互状态。

-   不要依赖 Xbox 帮助服务来获取与脱机状态相关的错误消息和帮助。 Xbox 帮助服务需要连接至 Xbox Live。

## <a name="conclusion"></a>总结

Xbox One 专为始终连接世界设计。 但是，在实现这一愿景的道路上，主机允许玩家在脱机情形下也能玩游戏。 在遇到连接故障时，游戏必须可靠。 对于具有脱机玩游戏体验的游戏，允许玩家最大限度地畅享这些体验。 对于在网络连接中断时始终处于联机状态的游戏，将用户从容地返回脱机状态。

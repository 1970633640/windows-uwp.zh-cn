---
Description: Microsoft Store 强制执行某些与版本号相关的规则，它们在不同的 OS 版本中的工作方式略有不同。
title: 程序包版本编号
ms.assetid: DD7BAE5F-C2EE-44EE-8796-055D4BCB3152
ms.date: 10/31/2018
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 7a8ce14094733ef5598c510198f4268744cb581e
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2019
ms.locfileid: "57621872"
---
# <a name="package-version-numbering"></a>程序包版本编号

你提供的每个程序包都必须具有一个版本号（采用应用清单中 **Package/Identity** 元素的 [Version](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity) 属性值进行提供）。 Microsoft Store 强制执行某些与版本号相关的规则，它们在不同的 OS 版本中的工作方式略有不同。

> [!NOTE]
> 本主题是指"包"，但除非另有说明，相同的规则适用于.msix/.appx 和.msixbundle/.appxbundle 文件的版本号。


## <a name="version-numbering-for-windows10-packages"></a>版本的 Windows 10 包编号

> [!IMPORTANT]
> 对于 Windows 10 (UWP) 包的版本号的最后一个 （第四个） 部分保留供存储使用和 （尽管存储可能会更改在本部分中的值） 生成包时必须保留为 0。 其他部分必须设置为 0 到 65535 （除了第一部分，不能为 0） 之间的整数。

在选择 UWP 包从你已发布的提交内容时，Microsoft Store 将始终使用适用于客户的 Windows 10 设备的最高已进行版本管理包。 这将为你提供更大的灵活性，并让你可以控制在特定设备类型上提供给客户的程序包。 重要的是，你可以按任意顺序提交这些程序包；你将并不局限于提供每个后续提交中的更高版本的程序包。

多个 UWP 包可以提供相同的版本号。 但是，共享一个版本号的程序包也不能拥有相同的体系结构，因为应用商店用于每个程序包的完整标识必须是唯一的。 有关详细信息，请参阅 [**Identity**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity)。

当你提供多个使用相同的版本号的 UWP 包时，（按顺序 x64，x86、 ARM，非特定语言） 的体系结构将用于决定哪一个是高的排名 （如果在存储区确定要提供给客户的设备将哪个包）。 当对使用相同版本号的应用程序包进行分级时，应考虑采用程序包内等级最高的体系结构：包含 x64 程序包的应用程序包的等级高于仅包含 x86 程序包的应用程序包的等级。

这将为你随时间推移不断优化你的应用提供了极大的灵活性。 可以上传并提交新的包，使用较低版本的数字将添加对您以前不支持的 Windows 10 设备的支持，你可以添加更高版本具有更严格的依赖关系，以充分利用硬件或操作系统功能，或您的软件包可以添加更高版本控制服务对某些或所有现有客户的更新作为基础的包。

下面的示例说明了如何管理版本编号，以便通过多个提交将预期的程序包交付给客户。

### <a name="example-moving-to-a-single-package-over-multiple-submissions"></a>示例：将移动到一个包通过多个提交

Windows 10，您可以编写一个基本代码，在任何位置运行。 这使得从全新的跨平台项目着手变得更加容易。 然而，出于多种原因，你可能不希望通过合并现有的基本代码立即创建单个项目。

包版本控制规则可用于逐渐将你的客户移动到对于通用设备系列中，一个包时随附了许多特定设备系列 （包括那些利用 Windows 10 Api） 的临时更新。 下面的示例说明了如何对一系列提交为同一应用一致地应用相同的规则。

| 提交 | 目录                                                  | 客户体验                                                                                                                                                                             |
|------------|-----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1          | 包版本：1.1.10.0 <br> 设备系列：Windows.Desktop，minVersion 10.0.10240.0 <br> <br> 包版本：1.1.0.0 <br> 设备系列：Windows.Mobile，minVersion 10.0.10240.0     | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10240.0 以及更高版本的设备将获得 1.1.0.0 <br> -   其他设备系列将无法购买和安装应用 |
| 2          | 包版本：1.1.10.0 <br> 设备系列：Windows.Desktop，minVersion 10.0.10240.0 <br> <br> 包版本：1.1.0.0 <br> 设备系列：Windows.Mobile，minVersion 10.0.10240.0 <br> <br> 包版本：1.0.0.0 <br> 设备系列：Windows.Universal，minVersion 10.0.10240.0    | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10240.0 以及更高版本的设备将获得 1.1.0.0 <br> -   其他（既非桌面版也非移动版）设备系列将在引入时获得 1.0.0.0 <br> -   已安装应用的桌面和移动设备将不会看到任何更新（因为它们已具有最适用的版本，即 1.1.10.0 和 1.1.0.0，这两者均高于 1.0.0.0） |
| 3          | 包版本：1.1.10.0 <br> 设备系列：Windows.Desktop，minVersion 10.0.10240.0 <br> <br> 包版本：1.1.5.0 <br> 设备系列：Windows.Universal，minVersion 10.0.10250.0 <br> <br> 包版本：1.0.0.0 <br> 设备系列：Windows.Universal，minVersion 10.0.10240.0    | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10250.0 以及更高版本的设备将获得 1.1.5.0 <br> -   使用 Windows 10 移动版且内部版本号在 10.0.10240.0 与 10.010250.0（包含前者，但不包含后者）之间的设备将获得 1.1.0.0 
| 4          | 包版本：2.0.0.0 <br> 设备系列：Windows.Universal，minVersion 10.0.10240.0   | -   使用 Windows 10 版本 v10.0.10240.0 及更高版本的所有设备系列上的全部客户将获得程序包 2.0.0.0 | 

> [!NOTE]
>  在所有情况下，客户的设备将接收包具有符合条件的最大可能的版本编号。 例如，在上面的第三个提交中，所有桌面设备都将获得 v1.1.10.0（即使它们具有 OS 版本 10.0.10250.0 或更高版本也是如此），因此它们还能接受 v1.1.5.0。 由于 1.1.10.0 是其最适用的最高版本号，因此即为它们将获取的程序包。

### <a name="using-version-numbering-to-roll-back-to-a-previously-shipped-package-for-new-acquisitions"></a>使用版本编号，可针对新获取的程序包回滚到以前交付的程序包

如果你一直在包的副本，您可以选择应用程序的包存储区中到早期的 Windows 10 包时回滚，您应发现问题的一个版本。 这是临时的方法来限制对你的客户造成中断，而您花时间来解决此问题。

若要执行此操作，创建一个新[提交](app-submissions.md)。 删除有问题的程序包并上载你想要在应用商店中提供的旧程序包。 已收到你正在回滚的程序包的客户仍然会具有出现问题的程序包（因为较旧程序包的版本号是早期的）。 但是，这将阻止任何其他用户获取有问题的程序包，同时将仍然允许在应用商店中提供该应用。

若要为已接收有问题的包的客户解决此问题，可以提交就立即可以具有更高版本的版本号高于错误包的新 Windows 10 包。 在该提交完成认证过程后，所有客户的程序包都将更新为新程序包，因为它具有更高的版本号。


## <a name="version-numbering-for-windows81-and-earlier-and-windows-phone-81-packages"></a>版本编号为 Windows 8.1 （及更早版本） 和 Windows Phone 8.1 包

> [!IMPORTANT]
> 自 2018 年 10 月 31 日起，新创建的产品不能包括面向 Windows 8.x/Windows 包 Phone 8.x 或更早版本。 有关详细信息，请参阅此[博客文章](https://blogs.windows.com/buildingapps/2018/08/20/important-dates-regarding-apps-with-windows-phone-8-x-and-earlier-and-windows-8-8-1-packages-submitted-to-microsoft-store/#SzKghBbqDMlmAO4c.97)。

对于面向 Windows Phone 8.1 的 .appx 程序包，新提交中的程序包版本号必须始终大于上一提交（或之前任意提交）中所含的程序包版本号。

对于面向 Windows 8 和 Windows 8.1 的.appx 包，相同的规则应用于每个体系结构： 新提交中的包的版本号必须始终为大于上次发布时间到相同的体系结构的存储的包。

此外，Windows 8.1 的包的版本号必须始终为大于任何同一应用程序在 Windows 8 包的版本号。 换而言之，在提交任何 Windows 8 包的版本号必须低于您提交为同一应用了任何 Windows 8.1 包的版本号。

> [!NOTE]
> 如果您的应用程序也有 Windows 10 的包，Windows 10 包的版本号必须是相对于任何 Windows 8/Windows 8.1 或 Windows Phone 8.1 包更高版本。 有关详细信息，请参阅[适用于 Windows 10 的包添加到以前发布的应用](guidance-for-app-package-management.md#adding-packages-for-windows-10-to-a-previously-published-app)。

下面是一些示例的面向 Windows 8 和 Windows 8.1 的包的不同版本编号更新方案中会发生什么情况。

| 应用商店中存在该版本的应用  | 并且上传该版本 | 在新版本位于 Microsoft Store 中之后，将在新的购置中安装此版本 | 在新版本位于 Microsoft Store 中之后，如果客户已经拥有该应用，只需更新便可。 |
|---------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------|----------|
| 无                                     | x86，v1.0.0.0               | x86，v1.0.0.0，在 x86 和 x64 计算机上                                                | 无。 |
| x86，v1.0.0.0                               | x64，v1.0.0.0               | v1.0.0.0，针对客户的体系结构                                                   | 无。 版本号相同。 |
| x86，v1.0.0.0 <br> x64，v1.0.0.0            | x64，v1.0.0.1               | v1.0.0.0，适用于使用 x86 的客户 <br> v1.0.0.1，适用于使用 x64 的客户                 | 无，针对在 x86 计算机上运行应用的客户。 <br> 对于在 x64 计算机上运行应用的客户，v1.0.0.0 将更新为 v1.0.0.1。 <br> **请注意**  如果 x86 版本的应用程序运行在 x64 计算机，该应用程序不会更新到 x64 版本除非客户卸载并重新安装。 |
| 无                                     | 中性，v1.0.0.1           | 中性，v1.0.0.1，在所有计算机上                                                         | 无。 |
| 中性，v1.0.0.1                           | x86，v1.0.0.0 <br> x64，v1.0.0.0 <br> ARM，v1.0.0.0 | v1.0.0.0，针对客户计算机的体系结构。          | 无。 拥有体系结构为 Neutral 的 v1.0.0.1 版本应用的客户将继续使用它。 |
| 中性，v1.0.0.1 <br> x86，v1.0.0.0 <br> x64，v1.0.0.0 <br> ARM，v1.0.0.0 | x86，v1.0.0.1 <br> x64，v1.0.0.1 <br> ARM，v1.0.0.1 | v1.0.0.1，针对客户计算机的体系结构。 | 无，针对运行中性，v1.0.0.1 版本应用的客户。 <br> 对于运行为其计算机的特定体系结构所构建应用的 v1.0.0.0 的客户，v1.0.0.0 将更新为 v1.0.0.1。 |
| x86，v1.0.0.1 <br> x64，v1.0.0.1 <br> ARM，v1.0.0.1 | x86，v1.0.0.2 <br> x64，v1.0.0.2 <br> ARM，v1.0.0.2 | v1.0.0.2，针对客户计算机的体系结构。  | 对于运行针对其计算机的特定体系结构所生成应用的 v1.0.0.1 的客户，v1.0.0.1 将更新为 v1.0.0.2。 |

> [!NOTE]
> 与 .appx 程序包不同，当确定向给定客户提供哪个程序包时，不考虑任何 .xap 程序包中的版本号。 若要将客户从一个 .xap 程序包更新到较新的程序包，请确保在新提交中删除旧的 .xap 程序包。

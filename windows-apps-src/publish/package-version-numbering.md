---
author: jnHs
Description: The Microsoft Store enforces certain rules related to version numbers, which work somewhat differently in different OS versions.
title: 程序包版本编号
ms.assetid: DD7BAE5F-C2EE-44EE-8796-055D4BCB3152
ms.author: wdg-dev-content
ms.date: 10/02/2018
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 7cf93cf06b273605b91c31da5b6a6b8cef8dae39
ms.sourcegitcommit: 4b97117d3aff38db89d560502a3c372f12bb6ed5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/23/2018
ms.locfileid: "5432555"
---
# <a name="package-version-numbering"></a>程序包版本编号

你提供的每个程序包都必须具有一个版本号（采用应用清单中 **Package/Identity** 元素的 **Version** 属性值进行提供）。 Microsoft Store 强制执行某些与版本号相关的规则，它们在不同的 OS 版本中的工作方式略有不同。

> [!NOTE]
> 本主题提及"程序包"，但除非另有说明，.msix/.appx 和.msixbundle/.appxbundle 文件的版本号应用相同的规则。


## <a name="version-numbering-for-windows-10-packages"></a>Windows 10 程序包的版本编号

> [!IMPORTANT]
> 对于 Windows 10 (UWP) 程序包，版本号的最后 （第四个） 部分会保留的应用商店使用，并且必须保留为 0 （尽管应用商店可能会更改此部分中的值） 生成程序包时。

当从已发布的提交中选择 UWP 程序包，Microsoft Store 将始终使用适用于客户的 Windows 10 设备的版本最高的程序包。 这将为你提供更大的灵活性，并让你可以控制在特定设备类型上提供给客户的程序包。 重要的是，你可以按任意顺序提交这些程序包；你将并不局限于提供每个后续提交中的更高版本的程序包。

你可以使用相同版本号提供多个 UWP 程序包。 但是，共享一个版本号的程序包也不能拥有相同的体系结构，因为应用商店用于每个程序包的完整标识必须是唯一的。 有关详细信息，请参阅 [**Identity**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity)。

当你提供多个使用相同版本号的 UWP 程序包时，体系结构 （顺序为 x64、 x86、 ARM、 neutral） 将用于确定哪一个是等级更高 （当在应用商店确定哪个程序包提供给客户的设备）。 当对使用相同版本号的应用程序包进行分级时，应考虑采用程序包内等级最高的体系结构：包含 x64 程序包的应用程序包的等级高于仅包含 x86 程序包的应用程序包的等级。

这将为你随时间推移不断优化你的应用提供了极大的灵活性。 你可以上传和提交新程序包，使用较低版本号添加对之前不支持你的 Windows 10 设备的支持，你可以添加具有更为严格的相关性充分利用硬件或操作系统功能，或你的更高版本的程序包可以添加版本号较高的程序包，用作对部分或全部现有客户更新基本。

下面的示例说明了如何管理版本编号，以便通过多个提交将预期的程序包交付给客户。

### <a name="example-moving-to-a-single-package-over-multiple-submissions"></a>示例：通过多个提交移至单个程序包

Windows 10 使你能够编写一个可在任意位置上运行的单个基本代码。 这使得从全新的跨平台项目着手变得更加容易。 然而，出于多种原因，你可能不希望通过合并现有的基本代码立即创建单个项目。

你可以使用程序包版本控制规则，针对通用设备系列逐步将你的客户移至单个程序包，同时交付特定设备系列（包括利用 Windows 10 API 的设备系列）的各种临时更新。 下面的示例说明了如何通过为相同应用提交的一系列一致地应用相同的规则。

| 提交 | 内容                                                  | 客户体验                                                                                                                                                                             |
|------------|-----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1          | -   程序包版本：1.1.10.0 <br> -   设备系列：Windows.Desktop，最低版本为 10.0.10240.0 <br> <br> -   程序包版本：1.1.0.0 <br> -   设备系列：Windows.Mobile，最低版本为 10.0.10240.0     | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10240.0 以及更高版本的设备将获得 1.1.0.0 <br> -   其他设备系列将无法购买和安装应用 |
| 2          | -   程序包版本：1.1.10.0 <br> -   设备系列：Windows.Desktop，最低版本为 10.0.10240.0 <br> <br> -   程序包版本：1.1.0.0 <br> -   设备系列：Windows.Mobile，最低版本为 10.0.10240.0 <br> <br> -   程序包版本：1.0.0.0 <br> -   设备系列：Windows.Universal，最低版本为 10.0.10240.0    | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10240.0 以及更高版本的设备将获得 1.1.0.0 <br> -   其他（既非桌面版也非移动版）设备系列将在引入时获得 1.0.0.0 <br> -   已安装应用的桌面和移动设备将不会看到任何更新（因为它们已具有最适用的版本，即 1.1.10.0 和 1.1.0.0，这两者均高于 1.0.0.0） |
| 3          | -   程序包版本：1.1.10.0 <br> -   设备系列：Windows.Desktop，最低版本为 10.0.10240.0 <br> <br> -   程序包版本：1.1.5.0 <br> -   设备系列：Windows.Universal，最低版本为 10.0.10250.0 <br> <br> -   程序包版本：1.0.0.0 <br> -   设备系列：Windows.Universal，最低版本为 10.0.10240.0    | -   使用 Windows 10 桌面版 10.0.10240.0 以及更高版本的设备将获得 1.1.10.0 <br> -   使用 Windows 10 移动版 10.0.10250.0 以及更高版本的设备将获得 1.1.5.0 <br> -   使用 Windows 10 移动版且内部版本号在 10.0.10240.0 与 10.010250.0（包含前者，但不包含后者）之间的设备将获得 1.1.0.0 
| 4          | -   程序包版本：2.0.0.0 <br> -   设备系列：Windows.Universal，最低版本为 10.0.10240.0   | -   使用 Windows 10 版本 v10.0.10240.0 及更高版本的所有设备系列上的全部客户将获得程序包 2.0.0.0 | 

> [!NOTE]
>  在所有情况下，客户设备都将收到具有其有资格获取的最高版本号的程序包。 例如，在上面的第三个提交中，所有桌面设备都将获得 v1.1.10.0（即使它们具有 OS 版本 10.0.10250.0 或更高版本也是如此），因此它们还能接受 v1.1.5.0。 由于 1.1.10.0 是其最适用的最高版本号，因此即为它们将获取的程序包。

### <a name="using-version-numbering-to-roll-back-to-a-previously-shipped-package-for-new-acquisitions"></a>使用版本编号，可针对新获取的程序包回滚到以前交付的程序包

如果你保留你的程序包的副本，你将可以选择你的应用包应用商店中回滚到早期 Windows 10 程序包，你应发现版本问题时。 这是一种限制对你的客户的中断，而花费时间来修复问题的方法。

若要执行此操作，请创建新的[提交](app-submissions.md)。 删除有问题的程序包并上载你想要在应用商店中提供的旧程序包。 已收到你正在回滚的程序包的客户仍然会具有出现问题的程序包（因为较旧程序包的版本号是早期的）。 但是，这将阻止任何其他用户获取有问题的程序包，同时将仍然允许在应用商店中提供该应用。

若要为已收到有问题的程序包的客户解决此问题，你可以提交新的 Windows 10 程序包，如你可以具有更高版本的版本号与程序包。 在该提交完成认证过程后，所有客户的程序包都将更新为新程序包，因为它具有更高的版本号。


## <a name="version-numbering-for-windows-81-and-earlier-and-windows-phone-81-packages"></a>适用于 Windows 8.1（和更早版本）以及 Windows Phone 8.1 程序包的版本编号

对于面向 Windows Phone 8.1 的 .appx 程序包，新提交中的程序包版本号必须始终大于上一提交（或之前任意提交）中所含的程序包版本号。

对于面向 Windows 8 和 Windows 8.1.的 .appx 程序包，将对每个体系结构应用相同的规则：新提交中的程序包版本号必须始终大于同一体系结构下上次发布至 Microsoft Store 的程序包版本号。

此外，Windows 8.1 程序包的版本号必须始终大于相同应用的任何 Windows 8 程序包的版本号。 换言之，你提交的任何 Windows 8 程序包的版本号都必须低于你已为相同应用提交的任何 Windows 8.1 程序包的版本号。

> [!NOTE]
> 如果你的应用还具有 Windows 10 程序包，Windows 10 程序包的版本号必须始终高于那些为你的任何 Windows 8、 Windows 8.1 和/或 Windows Phone 8.1 程序包。 有关详细信息，请参阅[将 Windows 10 程序包添加到以前发布的应用](guidance-for-app-package-management.md#adding-packages-for-windows-10-to-a-previously-published-app)。

下面是一些示例的不同版本的面向 Windows 8 和 Windows 8.1 的程序包的版本号更新方案中会发生什么情况。

| 应用商店中存在该版本的应用  | 并且上传该版本 | 在新版本位于 Microsoft Store 中之后，将在新的购置中安装此版本 | 在新版本位于 Microsoft Store 中之后，如果客户已经拥有该应用，只需更新便可。 |
|---------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------|----------|
| 无                                     | x86，v1.0.0.0               | x86，v1.0.0.0，在 x86 和 x64 计算机上                                                | 无。 |
| x86，v1.0.0.0                               | x64，v1.0.0.0               | v1.0.0.0，针对客户的体系结构                                                   | 无。 版本号相同。 |
| x86，v1.0.0.0 <br> x64，v1.0.0.0            | x64，v1.0.0.1               | v1.0.0.0，适用于使用 x86 的客户 <br> v1.0.0.1，适用于使用 x64 的客户                 | 无，针对在 x86 计算机上运行应用的客户。 <br> 对于在 x64 计算机上运行应用的客户，v1.0.0.0 将更新为 v1.0.0.1。 <br> **注意**  如果应用的 x86 版本在 x64 计算机上运行，则应用不会更新到 x64 版本，除非客户卸载应用后重新安装应用。 |
| 无                                     | 中性，v1.0.0.1           | 中性，v1.0.0.1，在所有计算机上                                                         | 无。 |
| 中性，v1.0.0.1                           | x86，v1.0.0.0 <br> x64，v1.0.0.0 <br> ARM，v1.0.0.0 | v1.0.0.0，针对客户计算机的体系结构。          | 无。 拥有体系结构为 Neutral 的 v1.0.0.1 版本应用的客户将继续使用它。 |
| Neutral，v1.0.0.1 <br> x86，v1.0.0.0 <br> x64，v1.0.0.0 <br> ARM，v1.0.0.0 | x86，v1.0.0.1 <br> x64，v1.0.0.1 <br> ARM，v1.0.0.1 | v1.0.0.1，针对客户计算机的体系结构。 | 无，针对运行中性，v1.0.0.1 版本应用的客户。 <br> 对于运行为其计算机的特定体系结构所构建应用的 v1.0.0.0 的客户，v1.0.0.0 将更新为 v1.0.0.1。 |
| x86，v1.0.0.1 <br> x64，v1.0.0.1 <br> ARM，v1.0.0.1 | x86，v1.0.0.2 <br> x64，v1.0.0.2 <br> ARM，v1.0.0.2 | v1.0.0.2，针对客户计算机的体系结构。  | 对于运行针对其计算机的特定体系结构所生成应用的 v1.0.0.1 的客户，v1.0.0.1 将更新为 v1.0.0.2。 |

> [!NOTE]
> 与 .appx 程序包不同，当确定向给定客户提供哪个程序包时，不考虑任何 .xap 程序包中的版本号。 若要将客户从一个 .xap 程序包更新到较新的程序包，请确保在新提交中删除旧的 .xap 程序包。
